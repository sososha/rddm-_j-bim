# パラメトリック建築図書ジェネレーターの開発計画

## 概要

- ビジョン
  - 間取りと簡単な情報を������す��ば、建築の現実的な可能性が見えてくるようにしたい。
    - 間取りの画像認識も将来的には必要かもしれない
    - 間取り自体を自動生成できるようにしたい。
  - 工務店のコストを減らす
  - 間取りの高練度、高密度化を容易にし��品質アップ���目指す
  - 施主と職人を近づける（このシステムと建築学を収めた「大工棟梁」がいれば、工務店いらずにする）
    - 施主の理解を促進する
    - 棟梁の負担をへらす
  - 伝統構法も視野にいれる。
- 前提
  - 今の住宅業界は高度で高価な autocad や archicad による BIM か、高価なホームズ君、または無料で低機能の jwcad の２極化状態である。
  - 最初���ら BIM を前提にした情報構築（図面作成等）がされれば、意匠図、構造計算、積算、法適合確認が容易であることは間違いない。
  - 問題は、無料または低価格の BIM システムがないことである。
  - そのギャップを解消したい。
  - ��������ア��キトレンド　このソフトが無料に近ければ、このプロダクトは不要になるものである。現状、100 万円コースで施主は使えない。
  - 例外事例：時刻歴応答解析ソフトの wallstat が無料利用可能である。
  - 例外事例：日本ではほぼ使われてないが、opencascade を利用した freecad や openscad が OSS で開発されている。
- 方針
  - まずは木造住宅にフォーカスして、低コストでつくりたい。
  - 木造住宅に限れば、プ��ン��構法���ほぼグリッドに従っており、対応範囲が狭くなる。
- 根本的なアイデア
  - 木造住宅で特殊なことをしない一般的な建築であれば、少ない建築図面で現実的に施工が可能であるので、間取り図と構造図さえあれば、一般的な住宅は建ちあがるのだ。この事実はとても重要だ。かつ、すべての部材は、構造材から下地を組んで取り付けられ���など、空中に浮いた部材は存在せず、何かしらに依存して位置決めされるので、すべての部材は相対的に定義づけが可能である。
  - BIM ��前段階の情報コアとして、木造住宅の構造体（柱、梁、土台、屋根）のジオメトリーを入力し、構成するシステムが必要である。
  - これは BIM での国際規格 IFC フォーマットでは、ジオメトリに対してパラメトリックに扱う方法は主要ではなく、静的パラメータが主体である。
  - 高さ情報や開口部情報、造作材はパラメトリックに変形されるべきである。
  - CEDXM というフォーマットもプレカットや現時点での住宅業界である程度普及している。ただし、この協議会は閉じた���ミュニティであり、���発��開発は期待されない。
    建築図書ジェネレーターと柔軟な使用のためには、構造ジオメトリの入力インターフェースとパラメトリックモデリングに対応させることが目標である。
  - 勝ち負け要素（プライオリティ）をプロパティとして持たせ、現実的な収まり（施工詳細）を表現できるようにする。
- 技術的問題
  - データを入力するためのフォーマットで適切なものがない、またフリーのライブラリで建築向けのものがない。そのため、簡単につくれなさそうである。
  - よって、fablic.js などのライブラリを用いて、建築向けのプロパティを追加した独自の XML データを構築する必要がある。
  - 構造と仕様詳細の xml がモデリングできたら、今度は図面としてのレンダリングだが、これは python を用いる（現段階では単���る��イデアである）
  - ��ンダリングして可視化が可能になったら、構造計算、法適合などの処理をしたいが、これもフリーのライブラリがあるわけではないので、オリジナルでつくる必要がある。既存の有料ソフトではおなじみの機能ではある。ただ、法律がベース��あり細����規定��れているので、やらなければいけないことは明確である。
- 技術的方法
  - ２ D の間取り入力が必要である
    - html5 の canvas 機能を用いる
  - XML を独自規格で保存し取り扱う（.stxml）
    - cedxm や ifc フォーマット��変換���きるように留意する
    - 同じく、skp や blender などでも扱えるとなお良い
  - 柱梁の高さ情報を入力する必要がある。
  - データベースは sqlite が可搬性があり、開発しやすい？
  - 2Dの作図フィールドと仕様書で軸組ジオメトリーを作成したら、図面ビューアーで確認。また、図面ビューアーで詳細な位置やシンボルの追加などを行う。図面ビューアー上での変更はリアルタイムで参照元も更新、またはプロパティ追加をする。すべての情報が���に��アルタイムで連携していることが重要。構造計算結果など重い処理が関係しているものについてユーザーの選択時に更新する。

## プロトタイプからつくるフロー

- A.２ D ＋レイヤー機能をもたせたインターフェースと仕様詳細入力ができるインターフェースにより建築 XML データを構築する
- B1.建築 XML データから図面をレンダリングする
  - 最初は構造部としてのベクトルだけのジオメトリーデータなので、構造材としての太さとほか部材との接合における勝ち負け（プライオリティ）から肉付けがされる。
  - ���面の種類によりレンダリングするビューポイントがかわる、平面図であれば、床上から 1500mm の部分での断面図として作図するのが基本である。
  - 作図ルールとして、構造体の切断面は太線、見え掛かりのものは細線、添景など意匠要素のものと、書き分けのための線は極細線である
  - 柱は太線の四角形に、交点を結んだ極細線の ☓ が作図される。
- B2.XML データから３ D をモデリングする（別途���ューア機能��必要）
- C1.積算
- C2.法適合
- C3.構造計算

## 必要なデータセット

- 建築部材の一覧
  建築部材一覧と標準サイズ

   - 構造材

    | 部材名 | 一般的な���イズ（mm） | 備考 |
    |--------|----------------------|------|
    | 柱 | 105 × 105, 120x120 | 木造住宅の標準寸法 |
    | 土台 | 105 × 105,120x120 | 基礎との接地部 |
    | 大引 | 90 × 90 | 土台間で長手方向、または直交して910間隔になるように設置される |
    | 梁 | 105 × 120 〜 330 | スパンによって変化 |
    | 母屋 | 90 × 90 〜 120 | 屋根を支える部材 |
    | 桁 | 105 × 120 〜 330 | 平屋や1階の主要構造材 |
    | 間柱 | 45 × 柱の寸法 | 壁の下地材 |
    | 胴縁 | 12~24 × 45 | 壁・天井の下地材 |
    | 床下地板 | 12~24 × 910 x 1820 | 床・屋根の下地材 |

  - 造作材

  | 部材名 | 一般的なサイズ（mm） | 備考 |
  |--------|----------------------|------|
  | 巾木 | 奥行8 × 高さ60 | 床と壁の境界 |
  | 廻り縁 | 15 × 30 | 天井と壁の境界 |
  | 窓枠 | 厚み25 奥行は仕上げ材から10mmはみ出す程度 | 窓の枠組み |
  | 建具枠 | 厚み25 奥行は仕上げ材から10mmはみ出す程度 | ドアの枠組み |

  - 屋根材

  | 部材名 | 一般的なサイズ（mm） | 備考 |
  |--------|----------------------|------|
  | 野地板 | 12,15,18 〜 24 厚 | 屋根下地材 |
  | 屋根下地材 | 1mm 厚 | 防水ルーフィング |
  | 瓦 | 約300 × 180 | 和���屋根材 |
  | 金属屋根材 | 約0.3 〜 0.6mm厚 | トタン、ガルバリウム鋼板 |

  - 外装材

  | 部材名 | 一般的なサイズ（mm） | 備考 |
  |--------|----------------------|------|
  | サイディング | 約1000 × 180 | 外壁仕上げ材 |
  | 通気胴縁 | 18 × 45 | サイディング下地 |
  | 透湿防水シート | 0.2mm厚 | 防水シート |
  | 断熱材 | 柱寸法と同寸 | 壁内部断熱 |

  - 床材

  | 部材名 | 一般的なサイズ（mm） | 備考 |
  |--------|----------------------|------|
  | フローリング | 12,15,18,24~30 厚 | 木質床材 |
  | 根太 | 45 × 45、45x55 ,他| 床下地材 |
  | 束 | 105 × 105,または鋼製束 | 大引支���材 |

  - 内装材

  | 部材名 | 一般的なサイズ（mm） | 備考 |
  |--------|----------------------|------|
  | 石膏ボード | 9.5 〜 12.5 厚 | 壁・天井下地材 |
  | クロス | 幅1000 | 壁紙 |

  | 部材名 | 一般的なサイズ（mm） | 備考 |
  |--------|----------------------|------|
  | 基礎コンクリート | 150 〜 300 厚 | 地盤������による |
  | 基礎���ッキン | 20 厚 | 木部と地盤の遮断 |
  | 捨てコン | 100 厚 | 基礎下地 |

  - 注意：サイズは一般的な木造住宅における標準的な寸法であり、実際の建築では地域、工法、設計によって異なる場合がある。

- 建築図書の一覧
  - 意匠図
    - 平面図
    - 平面詳細図
    - 立面図（北南東西）
    - 矩計図
    - 展開図
    - 配置図
  - 仕様書
    - 特記仕様書
    - 仕上表
    - 建具表
    - 設備表
    - 電気器具表
  - 構造図
    - 基礎図
    - 土台伏図
    - 各階床伏図
    - 各階天井伏図
    - 小屋伏図
    - 各通り断面図
  - 設備図
    - 電気図
    - 給排水図
    - 空調図
    - その他
  - 計算書
    - 構造計算書
    - ���エネ計算書
    - 積算計算書（見積もり）
  - 建築確認図書
    - 建築確認申請書
    - 設計図書
        確認申請用に図面を出力

- 作図ルールの一覧
  - 基本はA3用紙���である
  - 文書がメインの計算書はA4縦で構わない
  -線のルール
    - 太線、細線、極細線の３段階を使用。
    - 太線 0.5mm程度
      - 切断線を表す
    - 細線　0.2mm程度
    　　引き出し線にも使用
    - 極細線　0.1mm程度
      - 添景や模様の表現に使用
  - 図面一般
    - 共通の図枠を使用
    - 図枠の内容
      - 下部に1/100等の縮尺、図面作成者、その図面のバージョン、作成日付、図面のタイトル、承認者を記載。場合によっては屋号も記載。
      - 変更点の記載や承認版の記載がある場合はそれも記載
      - ���ガ��スの断面でなく見えている面の表現方法はガラス中央に３本の斜線を極細線で記載。フィックス窓の場合は右下に小さくFの字を記載。

  - 平面図
    - 次の内容を盛り込むこと
    - 方位は北を上にするのが基本である。設定によって変えても構わない。方位は偏角を記載(建物の住所情報が必要)
    - 主要な壁の中心線から　建物の外壁からはなして寸法線を描く。寸法線群の最外にすべての寸法の合計を表示
    - 開口部の内法寸法を記載
    - 各部屋の中央をに部屋名を記載（居室かどうかの判定に用いる）、部屋名の下に面積(㎡)を記載
    - 各床ごとにGL＋500等の床面の高さを記載
    -ビュー���イントは床面から1500mmが基本である。
    - 開き戸の戸先の軌道を極細の点線で描画する
    - 引き戸の戸先の軌道を極細の点線で描画する
    - ドアの開閉方向を記載
    - ���すりがある場合は手すりを記載
    - 設備シンボルがある場合、指示されたものを極細線や点線で記載（配電盤、物干し器具、スイッチ・コンセント、換気扇、煙感知器など）。設定で変えられるようにする。
    - 図枠に合計の床面積を記載（１/１００以下の数量は切り捨て）
    - 造作家具やキッチン設備、トイレ設備、紙巻器、バス設備を記載
    - 巾木も記載（記載の有無を設定できるようにする）
    - 家具も開き戸がある場合は戸先の開閉軌跡を点線表示
    - 階段は上り方向を矢印で明記
    - 建具番号、サッシ番号をそれぞれの近くに記載
    - 通り線を記載（910mm間隔で東よりX1,X2～、北からY1、Y2～）。通り芯の間隔は909の場合もあるので設定できるようにする。
    - 床板の貼り方向（目地の方向）を各部屋ごとに明記
    - 内装材に不燃材を使用している場合はその旨を���記（内装制限がある場合は記載が必要）
  - 立面図
    - 次の内容を盛り込むこと
    - 東西南北の図面を１枚に書き込む。図枠のうち図面記載部分を上下左右に４分割してそれぞれ使う
    - それぞれの���面の下にタイトルとして◯側立面図と記載
    軒樋と境界線、または軒先と境界線の距離を東西南北ごとに明記。
    もっとも屋外側に面する壁の通りの中心線から、樋先または樋がない場合は軒先までの距離を明記���
    ���根勾配を明記　
    - 高さに関して、どれか一つの立面について各高さを記載
      - GLから基礎高さ
      - 各階の床面の高さ
      - 各階の土台からの桁高さ、下階の桁上端からその階の桁上端までの高さ
      - GLから屋根の頂点までの最高高さ
    - 配置に関して、境界線を明示する。
    - 斜線を描き、法適合をわかりやすく明示する
      - 北側斜線
      - 隣地斜線
      - ������斜線
    - GLが水平でない場合は、平均の高さを直線の点線で明示し、それをGLとする。
    - 窓の種類を記号で記載
  - 矩計図　1/20
    - 平面図で指示した矩計図を描くためのビューポイントと方向の指示にしたがって屋外側の壁の中心線から屋内に向かって２.5間分の範囲で断面詳細図を描画する。
    - 引出線を用いて、外壁、床材、屋根材、軒天の材料と厚��、���番を明記��
    - 部屋の室内高さを明記
    - 窓の高さを明記
    - 部屋名を部屋の中央に明記
    - GLから1000mmまでの高さで防蟻処理を施す場合はその旨を明記���（設定できるようにする、法律上必要なのでデフォルトでON）
    - 断熱材は斜線で表現（設定で変更可能にする）
    - 次の高さを明記
      -GL=±0  ,GL~基礎天端、基礎パッキンがある場合は基礎天端～土台下端、土台下端～土台上端、土台上端～１F桁上端、１F桁上端から上階がある場合はその階の桁上端、上階がある場合は繰り返す
      - 基礎内部の土間上端から大引下端までの高さを明記（350mm���確保する必要がある）
      - GLから屋根の頂点までの高さを明記（最高高さ）
      - GLから最高の桁の高さを明記（最高桁高）
      - 屋根勾配を明記
    -展開図���1/50
      - 展開図一般
        - ビューポイントは各部屋の中央であり、東西南北を向いたときに見える室内立面である。
        - 部屋との境界に建具などがない場合は、その向こうに見えるものを極細線で描く。
        - 屋内の仕上げについてレンダリングする。（見えているものを描く）。
       - 各部屋の、各北東南西面について描画する。
       - 図面１枚につき、図枠の描画範囲を上下２分割し、それぞれについて描画��る。
       - 描画��た���開図ごとに部屋名と方位、床壁天井仕上げの仕上表をそれぞれ記載する。
       - 建具番号を記載
       - シンボルの位置、高さ情報により照明設備等を描画
         - 照明、スイッチ、コンセント
       - 建具の開き方向を記載
       - 造作家具も描画対象
       - 床の高さがかわるときは断面を描画（土間や框、見切りなど）
       -  　各窓について高さを明記（床～下窓枠の上端��上下窓枠の内法、上窓枠の下端から天井まで）
       - 部屋の天井高さを明記
       - 窓の種類を記号で記載
       - 作図対象の部屋の隣接する面（北を正面にしているとしたら東面と西面）��ついても断面として描画する、隣接する部屋との境界においてはその中心線から200mm向こうまで描画する。サッシや建具、開口がある場合は断面を描き、それぞれ高さを明記する。
       - 凡例として、スイッチ、コンセントの高さを明記する。
       - 煙感知器の高さについて、天井から高さ、近くの壁仕上げ面までの寸法を明記する。（法律で設置場所に規定がある）

- 構造計算のフローとデータセット
- 関連法律の一覧
  - 建築基準法
    - 建築物の敷地、構造、設備に関する最も基本的な法律
    - 建築物の安全性、防火、衛生などを規定
  - 都市計画法
    - 土地利用、都市計画、建築規制に関する法律
    - 用途地域、建ぺい率、容積率などを規定
  - 消防法
    - 建築物の防火、消火設備に関する法律
    - 避難経路、消火設備の設置基準を規定
  - 省エネ法（エネルギーの使用の合理化等に関する法律）
    - 建築物の省エネルギー性能に関する法律
    - 断熱性能���設備���率などを規定
  - 建築士法
    - 建築士の資格、業務に関する法律
    - 設計、監理の基準を規定
  - 住宅の品質確保の促進等に関する法律
    - 住宅の性能表示、瑕疵担保責任に関する法律
    - 住宅���能���価制度を規定
  - 長期優良住宅の普及の促進に関する法律
    - 長期にわたり良好な状態で使用できる住宅の普及を促進
    - 住宅の品質、性能に関する基準を規定
  - 建築物のエネルギー消費性能の向上に関する法律
    - 建築物のエネルギー���能の向上���図る法律
    - 省エネ基準、適合性判定などを規定
- 各フォーマットのプロパティ一覧
  - ifc
    - ifc スキーマ仕様 https://technical.buildingsmart.org/standards/ifc/ifc-schema-specifications/
    - ifc ドキュメント https://standards.buildingsmart.org/IFC/RELEASE/IFC4_3/
    - 4.3.2.0	IFC 4.3 ADD2 ISO 16739-1:2024	2024-04	Official に準拠したい
  - .stxml(このプログラムでつかう暫定的な中間保存用の規格)
    - ifc に変換することを前提にクラス名など同一のものを使用。
    - 独自のプロパティを追加する。何を追加しているかの差分を別途資料として用意。
- インターフェース
  - メイン画面
    - グローバルメニューバー
      - ファイル
        - 新規作成
        - 開く
        - 上書き保存
        - 名前を付けて保存
        - 最近使用したファイル
        - エクスポート
        - インポート
        - 印刷
        - 終了
      - 表示
      - 環境設定
      - そのた
        - 著作権
        - ヘルプ
        - バージョン
      - コミュニティ
    - ���報表示コラム
      - ifcプロパティ
      - ほかプロパティ
    - 切り替えタブ
      - ジオメトリ入力タブ
      - 仕様入力タブ
      - 図面タブ
      - 積算タブ
      - 法適合タブ
      - 構造計算タブ
    - ステータス表示バー
    - 入力フィールド
      - ジオメトリ入力タブの時
        - フィールド
            910mmグリッド
            グリッドスナップ
            グリッドの分割点へのスナップ（何分割かを設定��きるようにする、1/2,1/3,1/4,1/6,1/8,1/10）
            通り線をXYとも、うすい色の線で描画
            最初は横方向で２０グリッド分表示できるように初期位置を指定。
            入力している��の��一番��側をX1通り、一番上側をY1通りとして、910mmごとに通りの名前を描画。
            ダークモードとライトモードは選べるようにする。
            下の階、または土台の入力を透過表示。柱は●ではなくグリッドの15分の1サイズの☓で描画。
        - ツールバー
          - 入力コマンド
            - 柱（IfcColumn）入力
              - マウスクリックで入力
              - ジオメトリ上の点として入力
              - 表示サイズはグリッドの20分の1������でわかりやすい色で描画。
              - 小さな設定ウィンドを表示してプロパティを設定。
                - 基準点指定
                  - デフォルトは土台または下階の桁上端
                - 高さ入力
                  -デフォルトは土台または下階の桁上端からその階の桁上端まで（パラメトリック寸法）
                - 1F２Fを同じ材とする通し柱かどうかの選択
                - 断面寸法入力
                  -デフォルトは105 x 105。120x120、135x135,150x150,165x165,180x180の選択もプリセット
                - 材質設定
                  -デフォルトは杉
                - 勝ち負け入力
                  -柱優先の場合は���上端までの高さ、桁優先の場合はその桁下端までの高さ
                   - デフォルトは桁優先 
            - 梁（IfcBeam）入力
              -マウスクリックから次のクリックまでを線分として入力
              -始点から次クリックまでのマウスの位置を明る��線で表���し、���ウス��追いかけるようにする。
              -ジオメトリ上の線分として入力
              -小さなウィンドウを表示してプロパティを設定
                - 断面形状入力
                  -デフォルトは柱の径ｘ高さ（せい）は120
                - 材質設定
                  -デフォルトは杉
            - 開口部（IfcWindow）入力
              -マウスクリックから次のクリックまでを線分として入力
              -始点から次クリックまでのマウスの位置を明るい線で表示し、マウスを追いかけるようにする。
              -ジオメトリ上の線分として入力
              -小さなウィンドウを表示してプロパティを設定
                - 種類指定
                    - 全開口（床から天井まで）か、床から建具高さ（窓の場合は窓高さまで）か、腰上（寸法指定）から建具高さ（窓���場合は窓高さまで）か
                    - 開口部かサッシか、内部建具か
                      - 開口部とサッシと内部建具で線の色をわける。
                    - 枠の指定
                        ３方枠（左右と上）か４方枠（上下左右）か無枠か２方枠（左右）か。
                          -デフォルト
                             - 全開口の場合２方枠
                             - 床から建具高さ（窓の場合は窓高さまで）の場合３方枠
                             - 腰上（寸法指定）から建具高さ（窓の場合は窓高さまで）の場合４方枠
                - 寸法指定
                  - デフォルトはグリッド1つ分
                  -またはmmで指定
                  -またはクリックした点から次のクリックした点までを寸法として使用
                - 基準点指定（平面と高さ）
                  -デフォルト��クリック��次クリックの中心点
                  - 選択肢は始点、終点、中心点。
                  -高さの基準点はデフォルトは窓、または建具高さを基準に窓・建具の上枠の下端がくるように配置する（窓高さ、建具高さとして設定が必要）
                - 枠の厚さと深さ設定
                  - デフォルトは厚み25mm、深さは壁の仕上げ面から屋内側に向けて+10mm。
                  - 左右枠対上下枠の優先順位
                    - 左右枠優先か上下枠優先か、イーブン（留め）か。
                - 詳細な設定は平面図ビューや展開図ビューで設定変更をする。
            - 壁（IfcWall）入力
              - マウスクリックから次のクリックまでを線分として入力
              - 始点から次クリックまでのマウスの位置を明るい線で表示し、マウスを追いかけるようにする。
              - ジオメトリ上の線分として入力
              - 小さなウィンドウを表示してプロパティを設定
                - 壁種類を指定
                  - 構造壁か造作壁（非構造壁）��選択
                  - 造作壁の場合は、腰壁か垂れ壁か、その腰壁＋垂れ壁かを選択
                - 寸法指定
                  - デフォルトはクリックした点から次のクリックした点までを寸法として使用
                - 基準点指定（平面と高さ方向）��高さ指定
                  -デフォルトは最初のクリック点
                  -選択肢は始点、終点、中心点。
                  -高さの基準点はデフォルトは構造壁の場合、土台または下階の桁上端。その階の桁下端まで（パラメトリック寸法）
                  -高さの基準点はデフォルトは造作壁の場合、その床面。高さは床面から腰壁の上端までの寸法、または垂れ壁の下端までの寸法を指定。
            - 土台（IfcFoundation）入力
              - 梁の入力に準ずる
            - 屋���（IfcRoof）入力
              - 勾配入力
              - 材質選択
            - シンボル入力
              - シンボルの種類
                - 電気系統設備
                  - 照明
                  - コンセント
                  - スイッチ
                  - 情報通信設備
                  - 警報���
                  - ���犯設備
                - その他
              - シンボルのサイズ
              - シンボルの配置
          - 選択コマンド
            - ポインタで選択
            - 範囲選択（範囲にすべて含まれたら選択）
            - 部材指定選択
              - 指定部材の��を��マンド対象にする
              - 指定部材をすべて選択する
          - 固有化指定コマンド
          - 削除コマンド
            - ポインタで選択
            - 範囲選択（範囲にすべて含まれたら選択）
            - 部材指定選択
              -